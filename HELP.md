Клиент пишет
Ему отвечают - хорошо, вам ответит первый оператор

ждем свободного оператора
одному из свободных операторов пишем вы готовы принять клиента?
если за 20 сек не отвечает - пишем следующему и так в цикле

чат с клиентом кладется в бд
если есть активный оператор, то сразу пересылается ему
ответы оператора кладутся в бд и отправляются клиенту

оператор получает 20 последних сообщений клиента при начале общения
оператор может завершить чат

чат завершается при неответе клиента в течении 30 с
